@startuml Package Diagram
package "Presentation Layer (src/UI)" {
    [Views (XAML)]
    [Styles (XAML)]
    package "Presenters" {
        [MainPresenter]
        [HomePresenter]
        [ConfigPresenter]
        [LogsPresenter]
        [BatteryPresenter]
        [LoginPresenter]
        [UpdatePresenter]
        [DialogPresenter]
    }
}

package "Service Layer (src/Services)" {
    [ScanService]
    [RemoteUpdateService]
    [ExecutionService]
    [DriverMatchingService]
    [SelfUpdateService]
    [LogService]
    [ResourceService]
}

package "Core Layer (src/Core)" {
    [ConfigManager]
    [NetworkProbe]
    [AsyncJob]
    [RunspaceManager]
}

package "Model Layer (src/Models)" {
    [AppConfig]
    [DeviceContext]
}

package "Infrastructure" {
    [FileSystem (LocalAppData)]
    [RunspacePool]
    [DonutApp.ps1]
    [RemoteWorker.ps1]
    [InstallWorker.ps1]
}

[MainPresenter] --> [HomePresenter]
[MainPresenter] --> [ConfigPresenter]
[MainPresenter] --> [LogsPresenter]
[MainPresenter] --> [BatteryPresenter]

[HomePresenter] --> [ScanService]
[HomePresenter] --> [RemoteUpdateService]
[HomePresenter] --> [AsyncJob]
[HomePresenter] --> [DialogPresenter]

[BatteryPresenter] --> [AsyncJob]

[ScanService] --> [ExecutionService]
[RemoteUpdateService] --> [ExecutionService]
[RemoteUpdateService] --> [DriverMatchingService]

[ExecutionService] --> [RemoteWorker.ps1]
[ExecutionService] --> [NetworkProbe]

[ConfigPresenter] --> [ConfigManager]
[ConfigManager] --> [AppConfig]

[AsyncJob] --> [RunspaceManager]
[RunspaceManager] --> [RunspacePool]

[UpdatePresenter] --> [SelfUpdateService]
[LoginPresenter] --> [SelfUpdateService]
[SelfUpdateService] --> [InstallWorker.ps1]

@enduml
