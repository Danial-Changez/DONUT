@startuml Component Diagram
component "C# Wrapper" {
    [Donut.Launcher.exe]
}

component "UI Components (src/UI)" {
    [MainWindow.xaml]
    [HomeView.xaml]
    [ConfigView.xaml]
    [LogsView.xaml]
    [BatteryView.xaml]
    [DialogWindow.xaml]
    [LoginWindow.xaml]
}

component "PowerShell Scripts" {
    [Start-Donut.ps1]
    [DonutApp.ps1]
    [RemoteWorker.ps1]
    [InstallWorker.ps1]
}

component "PowerShell Classes (src)" {
    package "Presenters" {
        [MainPresenter]
        [HomePresenter]
        [ConfigPresenter]
        [LogsPresenter]
        [BatteryPresenter]
        [LoginPresenter]
        [UpdatePresenter]
        [DialogPresenter]
    }
    package "Services" {
        [ScanService]
        [RemoteUpdateService]
        [ExecutionService]
        [DriverMatchingService]
        [SelfUpdateService]
        [LogService]
        [ResourceService]
    }
    package "Core" {
        [ConfigManager]
        [NetworkProbe]
        [AsyncJob]
        [RunspaceManager]
    }
    package "Models" {
        [AppConfig]
        [DeviceContext]
    }
}

database "Configuration" {
    [config.json]
    [WSID.txt]
}

database "%LOCALAPPDATA%\\DONUT" {
    [config/]
    [logs/]
    [reports/]
}

[Donut.Launcher.exe] ..> [Start-Donut.ps1] : Hosts/Launches
[Start-Donut.ps1] ..> [MainPresenter] : Initializes
[MainPresenter] ..> [MainWindow.xaml] : Manages
[MainPresenter] ..> [HomePresenter] : Creates
[MainPresenter] ..> [BatteryPresenter] : Creates
[HomePresenter] ..> [ScanService] : Uses
[HomePresenter] ..> [RemoteUpdateService] : Uses
[HomePresenter] ..> [AsyncJob] : Creates
[ScanService] ..> [ExecutionService] : Uses
[RemoteUpdateService] ..> [ExecutionService] : Uses
[ExecutionService] ..> [RemoteWorker.ps1] : Invokes via PsExec
[AsyncJob] ..> [RunspaceManager] : Uses Pool
[SelfUpdateService] ..> [InstallWorker.ps1] : Invokes
@enduml
